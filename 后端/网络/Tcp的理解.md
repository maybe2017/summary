### 三次握手
1. 客户端发送SYN请求，随机产生一个seq = J，客户端进入SYN_SENT状态，等待服务端确认；
2. 服务端响应SYN + ACK(J+1), seq=k; 服务端进入SYN_RCVD状态
3. 客户端再次响应ACK(k+1); 彼此验证ack后，客户端和服务端进入ESTABLISHED状态

#### 为什么是三次？而不是二次？
1. TCP是可靠的传输控制协议，而三次握手是保证数据可靠传输又能提高传输效率的最小次数。
2. 三次握手的过程是通信双方互相告知序列号起始值，并确认对方已经收到了序列号起始值的必经步骤；
3. 如果只是两次握手，至多只有连接发起方的起始序列号能被确认，另一方选择的序列号得不到确认



### 四次挥手
1. 客户端向服务端发送一个FIN数据包（FIN =1,seq = u）主动断开连接；客户端处于FIN_WAIT1状态；
2. 服务端向客户端响应确认包（ACK = 1,ack = u+1）；此时服务端处于CLOSE_WAIT状态，客户端处于FIN_WAIT2状态；
3. 服务端向客户端发送FIN数据包(FIN = 1,seq = w)，以及确认包(ACK = 1,ack = u+1)，用来停止向客户端发送数据；
    ```
    1. 这个动作是告诉客户端：我的数据也发送完了，不再给你发数据了；
    2. 此时服务端处于LAST_ACK状态，客户端处于 `TIME_WAIT` 状态；
    3. `TIME_WAIT` 状态的客户端仍然可以接收服务端传过来的报文；
    ```
4. 客户端收到FIN数据包之后，发送一个(ACK =1,ack = w+1)报文应答
   ```
   1. 此时客户端处理TIME_WAIT状态；
   2. 需要过了一定时间（2MSL）以后，确保发送方的ACK可以到达接收方，防止已失效连接请求报文段出现在此连接中；
   ```