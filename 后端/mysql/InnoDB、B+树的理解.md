
### 首先认识下索引数据结构
1. mysql的数据是放在页里面的，一次数据I/O至少加载一页数据，这样是为了减少I/O资源浪费。
2. MySQL中B+树的 `一个节点大小为1页`，也就是16k。之所以设置为一页，是因为对于大部分业务，一页就足够了。
3. InnoDB的B+树中，非叶子节点存的是 `key和指针`；叶子节点存的是数据行。

### B+树数据的存储能有多少呢？
1. 对于非叶子节点，如果key使用的是bigint，则为8字节，指针在mysql中为6字节，一共是14字节，则16k能存放 16 * 1024/14 = 1170 个索引指针。
2. 对于叶子节点，如果一行数据大小为1k，那么一页就能存16条数据。
    ```
    // 树高度为2时(18720条数据)
    根节点存储索引指针节点，那么它有1170个叶子节点存储数据，每个叶子节点可以存储16条数据，一共 `1170 x 16 = 18720` 条数据。

    // 树高度为3时(21902400条数据)
    可以存放 `1170 x 1170 x 16 = 21902400` 条数据（两千多万条数据），也就是对于两千多万条的数据。
    ```
3. 在实际应用中InnoDB中，B+树高度一般为3层时就可以存储`两千多万条`数据，通过主键查询`只需要3次IO操作`就能查到对应数据。所以一个节点为1页，也就是16k是比较合理的。

### B+树的缺点

#### 一、插入更新慢？
1. 首先要明确B+树在查询过程中应该是不会慢的，是在某种场景下插入或更新时较慢。
2. 在数据插入`比较无序`的时候，如先插入5，然后10000、然后3、然后800，这样跨度很大的数据的时候，就需要先 `找到这个数据应该被插入的位置`，然后插入数据。
3. 这个查找位置的过程，如果非常离散，那么就意味着每次查找的时候，他的叶子节点都不在内存中，这时候就必须使用磁盘寻道时间来进行查找了。更新原理基本与插入相同。

### 二、页分裂